import { Key } from '../../../../types.ts.esnext';
import React$1, { useEffect } from 'react';
import { ThemeProvider as ThemeProvider$1 } from '../../../ThemeProvider/ThemeProvider.tsx.esnext';
import { classNames } from '../../../../utilities/css.ts.esnext';
import { MobileCancelMajor } from '@shopify/polaris-icons';
import { Icon as Icon$1 } from '../../../Icon/Icon.tsx.esnext';
import { KeypressListener as KeypressListener$1 } from '../../../KeypressListener/KeypressListener.tsx.esnext';
import { Button as Button$1 } from '../../../Button/Button.tsx.esnext';
import styles from './Toast.scss.esnext';

const DEFAULT_TOAST_DURATION = 5000;
const DEFAULT_TOAST_DURATION_WITH_ACTION = 10000;

var _ref = /*#__PURE__*/React$1.createElement(Icon$1, {
  source: MobileCancelMajor
});

function Toast({
  content,
  onDismiss,
  duration,
  error,
  action
}) {
  useEffect(() => {
    let timeoutDuration = duration || DEFAULT_TOAST_DURATION;

    if (action && !duration) {
      timeoutDuration = DEFAULT_TOAST_DURATION_WITH_ACTION;
    } else if (action && duration && duration < DEFAULT_TOAST_DURATION_WITH_ACTION) {
      // eslint-disable-next-line no-console
      console.log('Toast with action should persist for at least 10,000 milliseconds to give the merchant enough time to act on it.');
    }

    const timer = setTimeout(onDismiss, timeoutDuration);
    return () => {
      clearTimeout(timer);
    };
  }, [action, duration, onDismiss]);
  const dismissMarkup = /*#__PURE__*/React$1.createElement("button", {
    type: "button",
    className: styles.CloseButton,
    onClick: onDismiss
  }, _ref);
  const actionMarkup = action ? /*#__PURE__*/React$1.createElement("div", {
    className: styles.Action
  }, /*#__PURE__*/React$1.createElement(Button$1, {
    plain: true,
    monochrome: true,
    onClick: action.onAction
  }, action.content)) : null;
  const className = classNames(styles.Toast, error && styles.error);
  return /*#__PURE__*/React$1.createElement(ThemeProvider$1, {
    theme: {
      colorScheme: 'inverse'
    }
  }, /*#__PURE__*/React$1.createElement("div", {
    className: className
  }, /*#__PURE__*/React$1.createElement(KeypressListener$1, {
    keyCode: Key.Escape,
    handler: onDismiss
  }), content, actionMarkup, dismissMarkup));
}

export { DEFAULT_TOAST_DURATION, DEFAULT_TOAST_DURATION_WITH_ACTION, Toast };
